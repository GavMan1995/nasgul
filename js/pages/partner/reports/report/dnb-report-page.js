import React from 'react'
import { connect } from 'react-redux'

import BureauTabs from '../components/bureau-tabs'
import EnterpriseCard from '../components/enterprise-card'
import EnterpriseHeader from '../components/enterprise-header'
import ScoreDisplay from '../components/score-display'
import SectionTabs from '../components/section-tabs'

import BusinessInformationCard from '../components/business-information-card'
import TaxLiensCard from '../components/tax-liens-card'

import BrandingImage from '../components/branding-image'
import CDNLogo from '../../../../common/components/cdn-logo'
import ReportSummaryCard from '../components/dnb/report-summary-card'
import ScoreSectionScoreFactors from '../components/score-section-score-factors'
import LawsuitsCard from '../components/dnb/lawsuits-card'
import TradelinesCard from '../components/dnb/tradelines-card'
import UccFilingsCard from '../components/dnb/ucc-filings-card'
import scoreModelForReportType from '../utils/score-model-for-report-type'
import safeStringToNumber from '../utils/safe-string-to-number'

function DnbReportPage ({ location, report, business }) {
  const score = scoreModelForReportType(report.attributes.scores, report.type)
  const scoreValue = safeStringToNumber(score.value)

  return (
    <div className='c-enterprise'>
      <div className='c-enterprise-pdf-header'>
        <div className='c-enterprise-pdf-header__score-container'>
          <img src='https://dxkdvuv3hanyu.cloudfront.net/images/dun+%26+bradstreet-logo.png' />
          <p>PAYDEX&reg;</p>
          <h1><strong>{scoreValue}</strong>/100</h1>
          <p>
            PAYDEX&reg; is a business credit score that’s generated by Dun & Bradstreet
            (D&B). Their model analyzes a business’ payment performance
            (i.e., if it pays its bills on time) and gives it a numerical score
            from 1 to 100, with 80 signifying a perfect payment history.
          </p>
        </div>
      </div>

      <EnterpriseHeader />

      <EnterpriseCard>
        <BureauTabs report={report} />

        <SectionTabs location={location} report={report} />

        <div className='c-enterprise-score'>
          <ScoreDisplay report={report} />

          <ScoreSectionScoreFactors report={report} />
        </div>
      </EnterpriseCard>

      <BusinessInformationCard report={report} />

      <ReportSummaryCard report={report} />

      <LawsuitsCard report={report} />

      <UccFilingsCard report={report} />

      <TaxLiensCard report={report} />

      <TradelinesCard report={report} />

      <div className='c-enterprise-pdf-footer'>
        <p>Report provided by</p>
        <img src='https://dxkdvuv3hanyu.cloudfront.net/images/nav/logo-name-blue.svg' />
      </div>
    </div>
  )
}

function mapStateToProps ({ business }) {
  return { business }
}

export default connect(mapStateToProps)(DnbReportPage)
